#RSA
题目：
![[低加密指数攻击.py]]
```python
from Crypto.Util.number import *
from uuid import uuid1

flag = 'flag{'+str(uuid1())+'}'
print(flag)

p = getPrime(512)
q = getPrime(512)
e = 3
n = p*q

m = bytes_to_long(flag.encode())
c = pow(m,e,n)
print('n =',n)
print('c =',c)


# n = 104332128652535899007070478758547198380805949526886278028913686965547598790030981538503217689575971799253416496214729515546745215170208677012065140542403042869525708706721850362616052095263300051788328242146985812628802309991277089090995711294370000676066744299974444307032121021342630438446105011672309309977
# c = 175676150266431939699464613238518940008790091866189344373670015753258933340960338799634157003056727643098785516118935670842018409096325186005219646481872146665384834183935747742151972894825981209208769863941155938054453950767114335954909590061670803123312539300693121072457653163665156196792390432541029

```
解题脚本：
```python
import gmpy2
from Crypto.Util.number import long_to_bytes

n = 104332128652535899007070478758547198380805949526886278028913686965547598790030981538503217689575971799253416496214729515546745215170208677012065140542403042869525708706721850362616052095263300051788328242146985812628802309991277089090995711294370000676066744299974444307032121021342630438446105011672309309977
c = 175676150266431939699464613238518940008790091866189344373670015753258933340960338799634157003056727643098785516118935670842018409096325186005219646481872146665384834183935747742151972894825981209208769863941155938054453950767114335954909590061670803123312539300693121072457653163665156196792390432541029

# 计算立方根
m, is_exact = gmpy2.iroot(c, 3)
if not is_exact:
    # 如果不是精确的立方根，可能需要尝试调整（例如，m可能是整数但gmpy2由于精度问题认为不精确？）
    # 我们可以尝试m-1, m, m+1
    m = int(m)
    if pow(m, 3, n) == c:
        pass
    elif pow(m+1, 3, n) == c:
        m = m+1
    elif pow(m-1, 3, n) == c:
        m = m-1
    else:
        print("无法精确求解立方根")
        exit()
else:
    m = int(m)

# 将整数m转换为字节串
flag_bytes = long_to_bytes(m)
try:
    flag_str = flag_bytes.decode('utf-8')
    print("Flag:", flag_str)
except:
    print("转换为字符串失败，字节串为:", flag_bytes)

```
