#RSA

## 题目概述

这道题目是一个关于 **[[RSA]] 加密** 的基础题。给定了一段通过 RSA 加密后的密文，要求我们通过已知的 **p**、**q**（两个大质数）和加密指数 **e** 来解密密文，最终得到原始的消息（即 flag）。

## RSA 加密算法简介

RSA 是一种常见的公钥加密算法，主要由以下几个部分构成：

1. **公钥**（公开）：由 **n** 和 **e** 组成。
   - **n = p * q**：是两个质数的乘积。
   - **e**：是公钥指数，通常选择较小的数，且一般为 65537。

2. **私钥**（私密）：由 **d** 组成。
   - **d** 是私钥指数，计算方法为 **d ≡ e⁻¹ mod φ(n)**，其中 **φ(n)** 为欧拉函数 **φ(n) = (p - 1) * (q - 1)**。

3. **加密**：
   - 明文消息 **m** 会被转换成整数并通过公式 **c = m^e mod n** 进行加密，得到密文 **c**。

4. **解密**：
   - 密文 **c** 通过公式 **m = c^d mod n** 进行解密，得到明文 **m**。

## 题目代码分析

以下是题目中提供的 Python 代码：

```python
from Crypto.Util.number import *
from uuid import uuid1

flag = 'flag{'+str(uuid1())+'}'
print(flag)

m = bytes_to_long(flag.encode())
p = getPrime(512)
q = getPrime(512)
e = 65537
n = p * q
c = pow(m, e, n)

print(f'p = {p}')
print(f'q = {q}')
print(f'c = {c}')
```

在这段代码中：

1. **flag 的生成**：
   - `flag` 是通过 `uuid1()` 生成的一个唯一标识符，将其转化为字符串并以 `flag{}` 的形式包装。
   
2. **加密过程**：
   - 将 flag 转换为整数 `m`，然后通过两个大质数 `p` 和 `q` 计算出 `n = p * q`，然后用 RSA 公钥加密公式计算密文 `c = m^e mod n`。
   
3. **输出**：
   - 输出了生成的质数 `p` 和 `q`，以及密文 `c`。

## 解题步骤

1. **计算私钥 d**：
   - 使用公式 **d = e⁻¹ mod φ(n)** 计算私钥。首先计算 **φ(n) = (p - 1) * (q - 1)**，然后求出 **d**。

2. **解密密文**：
   - 使用解密公式 **m = c^d mod n** 计算得到明文 **m**，该明文是整数形式。

3. **转换为 flag**：
   - 最后，将得到的明文整数转换为字节并解码为字符串，即得到原始的 flag。

## 解题代码【标准的RSA】

```python
from Crypto.Util.number import inverse, long_to_bytes

# 提供的参数
p = 8941338360024101857170325543800988897599603225532615265070816654139142870151082508160403975093822138246017645108183707144050434990181695403135098068827511
q = 12682903109754614245056911427531860328079631638644183706695161052890537251822095476234230189876605694923510729862298111484224202868715190070329855236125027
c = 111343904557242557233510498696503015198464162714384616304925042102185128860165834504633912916877296310400396683559209551008744311491782388970267285699507349110130304112513156681527662262330773740488597998383079202649419768470278433304386115625522892464900605637920604285263348453192746149573458558450666676857

# RSA 参数
n = p * q
e = 65537
phi_n = (p - 1) * (q - 1)

# 计算私钥 d
d = inverse(e, phi_n)

# 解密密文
m = pow(c, d, n)

# 将解密后的结果转换为字节并解码为字符串
flag = long_to_bytes(m).decode()
print(flag)
```

## 解题结果

通过上述步骤计算得出，最终解密得到的 flag 为：

**flag{8380425f-52b5-11f0-ae85-f89e94c129d4}**

## 总结

本题通过实现基本的 RSA 解密过程，帮助我们理解了如何通过已知的公钥参数（如质数 p 和 q）来解密 RSA 加密后的消息。掌握 RSA 算法的原理和操作步骤是理解许多密码学问题的基础。在 CTF 挑战中，类似的题目常见于破解和加密解密模块。

---
